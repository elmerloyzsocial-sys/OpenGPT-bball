<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Basketball Scoreboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <img src="assets/logo.png" alt="Event Logo" class="event-logo">
        <h1>BASKETBALL TOURNAMENT SCOREBOARD</h1>
    </header>
    <main>
        <div class="team-names-edit">
            <label>
                Team 1 Name: <input type="text" id="team1NameInput" value="Team 1">
            </label>
            <label>
                Team 2 Name: <input type="text" id="team2NameInput" value="Team 2">
            </label>
            <button id="updateNamesBtn">Update Names</button>
        </div>
        <div class="tabs">
            <button id="team1Tab" class="active">Team 1</button>
            <button id="team2Tab">Team 2</button>
        </div>
        <section id="scoreboard">
            <div class="scores">
                <span id="team1Name">Team 1</span>
                <span id="team1Score" class="score">0</span>
                <span>:</span>
                <span id="team2Score" class="score">0</span>
                <span id="team2Name">Team 2</span>
            </div>
            <!-- Replace the "Time" section inside .game-info with this editable input and button: -->
            <div class="game-info">
                <span>
                    Quarter: 
                    <input type="number" id="quarterInput" min="1" max="4" value="1" style="width:2.5em;">
                    <button id="updateQuarterBtn">Set</button>
                </span>
                <span>
                    Time: 
                    <input type="text" id="timerInput" value="10:00" style="width:5em;" pattern="^[0-9]{1,2}:[0-9]{2}$" title="MM:SS">
                    <button id="updateTimeBtn">Set</button>
                    <span id="timer" style="margin-left:0.5em;">10:00</span>
                </span>
                <button id="startBtn">Start</button>
                <button id="pauseBtn">Pause</button>
                <button id="resetBtn">Reset</button>
                <button id="saveQuarterBtn" style="background:#34a853;color:#fff;">Save Quarter to Drive</button>
            </div>
            <textarea id="quarterExport" style="width:95vw;max-width:600px;height:100px;display:none;margin:1rem auto;"></textarea>
            <div id="quarterInstructions" style="display:none;text-align:center;color:#34a853;">
                <p>Copy the summary and paste it into <a href="https://drive.google.com" target="_blank">Google Drive</a> (e.g. Docs or Sheets).</p>
            </div>
        </section>
        <section id="playersList">
            <h2 style="margin-top:2rem;">Registered Players Stats</h2>
            <div class="players-grid">
                <!-- 15 players, placeholder image and names -->
                <!-- You can update player names and images as needed -->
                <script>
                    // Player data
                    const players = [
                        { name: "Player 1", img: "assets/players/player1.png" },
                        { name: "Player 2", img: "assets/players/player2.png" },
                        { name: "Player 3", img: "assets/players/player3.png" },
                        { name: "Player 4", img: "assets/players/player4.png" },
                        { name: "Player 5", img: "assets/players/player5.png" },
                        { name: "Player 6", img: "assets/players/player6.png" },
                        { name: "Player 7", img: "assets/players/player7.png" },
                        { name: "Player 8", img: "assets/players/player8.png" },
                        { name: "Player 9", img: "assets/players/player9.png" },
                        { name: "Player 10", img: "assets/players/player10.png" },
                        { name: "Player 11", img: "assets/players/player11.png" },
                        { name: "Player 12", img: "assets/players/player12.png" },
                        { name: "Player 13", img: "assets/players/player13.png" },
                        { name: "Player 14", img: "assets/players/player14.png" },
                        { name: "Player 15", img: "assets/players/player15.png" },
                    ];
                </script>
                <div id="playersStats"></div>
            </div>
            <style>
                .players-grid {
                    display: flex;
                    flex-wrap: wrap;
                    gap: 1.5rem;
                    justify-content: center;
                    margin-top: 1rem;
                }
                .player-card {
                    background: #f9f9f9;
                    border-radius: 8px;
                    box-shadow: 0 2px 6px rgba(0,0,0,0.07);
                    width: 180px;
                    padding: 1rem;
                    text-align: center;
                    position: relative;
                    transition: box-shadow 0.2s;
                }
                .player-card:hover {
                    box-shadow: 0 4px 12px rgba(0,0,0,0.14);
                }
                .player-logo {
                    width: 60px;
                    height: 60px;
                    object-fit: cover;
                    border-radius: 50%;
                    margin-bottom: 0.5em;
                }
                .stat-row {
                    display: flex;
                    align-items: center;
                    justify-content: space-between;
                    margin: 0.4em 0;
                }
                .stat-label {
                    font-size: 0.98em;
                }
                .stat-value {
                    font-weight: bold;
                    font-size: 1.15em;
                    padding: 0 0.5em;
                }
                .stat-btn {
                    background: #1877f2;
                    color: #fff;
                    border: none;
                    border-radius: 4px;
                    padding: 0.15em 0.5em;
                    font-size: 1em;
                    cursor: pointer;
                    margin-left: 0.3em;
                }
                /* New for player name editing */
                .edit-player-btn {
                    background: none;
                    border: none;
                    color: #1877f2;
                    cursor: pointer;
                    margin-left: 0.3em;
                    font-size: 1.1em;
                    vertical-align: middle;
                }
                .player-name-input {
                    width: 90px;
                    font-size: 1em;
                    text-align: center;
                }
            </style>
            <script>
                // Render the players stats cards
                function renderPlayersStats() {
                    let html = '';
                    players.forEach((p, idx) => {
                        html += `
                        <div class="player-card" id="playerCard${idx}">
                            <img src="${p.img}" alt="${p.name} Logo" class="player-logo" onerror="this.src='assets/players/default.png'">
                            <div>
                                <strong id="playerNameDisplay${idx}">${p.name}</strong>
                                <button class="edit-player-btn" title="Edit Player Name" onclick="editPlayerName(${idx})">&#9998;</button>
                            </div>
                            <div id="playerNameEdit${idx}" style="display:none;">
                                <input type="text" class="player-name-input" id="playerNameInput${idx}" value="${p.name}" maxlength="24">
                                <button class="stat-btn" onclick="savePlayerName(${idx})">Save</button>
                                <button class="stat-btn" style="background:#999;" onclick="cancelPlayerNameEdit(${idx})">Cancel</button>
                            </div>
                            <div class="stat-row">
                                <span class="stat-label">Points</span>
                                <span class="stat-value" id="points${idx}">0</span>
                                <button class="stat-btn" onclick="updateStat(${idx}, 'points', 1)">+</button>
                                <button class="stat-btn" onclick="updateStat(${idx}, 'points', -1)">-</button>
                            </div>
                            <div class="stat-row">
                                <span class="stat-label">Rebounds</span>
                                <span class="stat-value" id="rebounds${idx}">0</span>
                                <button class="stat-btn" onclick="updateStat(${idx}, 'rebounds', 1)">+</button>
                                <button class="stat-btn" onclick="updateStat(${idx}, 'rebounds', -1)">-</button>
                            </div>
                            <div class="stat-row">
                                <span class="stat-label">Assists</span>
                                <span class="stat-value" id="assists${idx}">0</span>
                                <button class="stat-btn" onclick="updateStat(${idx}, 'assists', 1)">+</button>
                                <button class="stat-btn" onclick="updateStat(${idx}, 'assists', -1)">-</button>
                            </div>
                        </div>
                        `;
                    });
                    document.getElementById('playersStats').innerHTML = html;
                }

                // Stats state
                const playerStats = Array(15).fill(0).map(() => ({
                    points: 0,
                    rebounds: 0,
                    assists: 0
                }));

                // Stat update function
                function updateStat(idx, stat, delta) {
                    if (
                        (playerStats[idx][stat] + delta) >= 0
                    ) {
                        playerStats[idx][stat] += delta;
                        document.getElementById(`${stat}${idx}`).innerText = playerStats[idx][stat];
                    }
                }

                // Editable player name functions
                function editPlayerName(idx) {
                    document.getElementById(`playerNameDisplay${idx}`).style.display = 'none';
                    document.querySelector(`#playerCard${idx} .edit-player-btn`).style.display = 'none';
                    document.getElementById(`playerNameEdit${idx}`).style.display = 'block';
                    document.getElementById(`playerNameInput${idx}`).focus();
                }
                function savePlayerName(idx) {
                    const newName = document.getElementById(`playerNameInput${idx}`).value.trim() || "Player " + (idx+1);
                    players[idx].name = newName;
                    document.getElementById(`playerNameDisplay${idx}`).innerText = newName;
                    document.getElementById(`playerNameDisplay${idx}`).style.display = 'inline';
                    document.querySelector(`#playerCard${idx} .edit-player-btn`).style.display = 'inline-block';
                    document.getElementById(`playerNameEdit${idx}`).style.display = 'none';
                }
                function cancelPlayerNameEdit(idx) {
                    document.getElementById(`playerNameInput${idx}`).value = players[idx].name;
                    document.getElementById(`playerNameDisplay${idx}`).style.display = 'inline';
                    document.querySelector(`#playerCard${idx} .edit-player-btn`).style.display = 'inline-block';
                    document.getElementById(`playerNameEdit${idx}`).style.display = 'none';
                }

                // Support Enter key for quick editing
                document.addEventListener('DOMContentLoaded', function() {
                    renderPlayersStats();
                    // Attach keydown for input fields after initial render
                    players.forEach((_, idx) => {
                        document.addEventListener('keydown', function(e) {
                            const input = document.getElementById(`playerNameInput${idx}`);
                            if (input && input === document.activeElement) {
                                if (e.key === 'Enter') {
                                    savePlayerName(idx);
                                }
                                if (e.key === 'Escape') {
                                    cancelPlayerNameEdit(idx);
                                }
                            }
                        });
                    });
                });
            </script>
        </section>
        <!-- Print to Google Drive button and export area -->
        <button id="printToDriveBtn" style="margin:2rem auto;display:block;background:#1877f2;color:#fff;padding:0.7rem 1.5rem;border-radius:8px;border:none;cursor:pointer;font-size:1.1rem;">Print All[...]</button>
        <textarea id="driveExport" style="width:95vw;max-width:600px;height:220px;display:none;margin:1rem auto 2rem auto;"></textarea>
        <div id="driveInstructions" style="display:none;text-align:center;color:#1877f2;">
            <p>1. Press Ctrl+C to copy the summary above.</p>
            <p>2. Open <a href="https://drive.google.com/" target="_blank">Google Drive</a> (Docs or Sheets) and paste into your document.</p>
        </div>
    </main>
    <script src="script.js"></script>
    <script>
        // Print to Google Drive function
        document.getElementById('printToDriveBtn').addEventListener('click', function () {
            // Gather main data
            const team1Name = document.getElementById('team1Name').innerText;
            const team2Name = document.getElementById('team2Name').innerText;
            const team1Score = document.getElementById('team1Score').innerText;
            const team2Score = document.getElementById('team2Score').innerText;
            const quarter = document.getElementById('quarterInput').value;
            const timer = document.getElementById('timer').innerText;

            // Gather player stats
            let playerSummary = 'Player Stats:\n';
            if (typeof players !== 'undefined' && typeof playerStats !== 'undefined') {
                players.forEach((p, idx) => {
                    playerSummary += `${p.name} | Points: ${playerStats[idx].points}, Rebounds: ${playerStats[idx].rebounds}, Assists: ${playerStats[idx].assists}\n`;
                });
            }

            // Compose export string
            let exportString = `BASKETBALL TOURNAMENT SCOREBOARD\n\nTeam 1: ${team1Name} | Score: ${team1Score}\nTeam 2: ${team2Name} | Score: ${team2Score}\nQuarter: ${quarter}\nTime: ${timer}\n\n${playerSummary}`;

            // Show in textarea and instructions
            const exportArea = document.getElementById('driveExport');
            exportArea.value = exportString;
            exportArea.style.display = 'block';

            document.getElementById('driveInstructions').style.display = 'block';
            exportArea.focus();
            exportArea.select();
        });
    </script>
</body>
</html>
